#                                                               1
#                Office of the Health and Disability Commissioner
#                                                               1
#    Office of the Parliamentary Commissioner for the Environment
#                                                              10
#                                            Omahu Urology Clinic
#                                                               2
#                                            OMV New Zealand Ltd.
#                                                               3
#                                           Oncology Surgery Ltd.
#                                                               7
#                                 Open Polytechnic of New Zealand
#                                                               2
#                                           OPRA Consulting Group
#                                                               8
#                                         Optimal Clinical Trials
#                                                               6
#                              Opus International Consultants Ltd
#                                                               3
#                                              Oracle New Zealand
#                                                               6
#                                              Oral Health Centre
#                                                               2
#                                               Orange Consulting
#                                                               2
#                                                   Orb Solutions
#                                                               6
#                                      Organ Donation New Zealand
#                                                               9
#                                             Oritain Global Ltd.
#                                                               2
#                           Ornithological Society of New Zealand
#                                                              10
#                                           Orokonui Ecosanctuary
#                                                               6
#                                                           OSPRI
#                                                               5
#                                         Otago Community Hospice
#                                                               8
#                        Otago Computational Modelling Group Ltd.
#                                                               8
#                                    Otago Daily Times Collective
#                                                               2
#                                         Otago Girls High School
#                                                               6
#                                                    Otago Museum
#                                                               3
#                                               Otago Polytechnic
#                                                               8
#                                          Otago Regional Council
#                                                               3
#                                                 Otahuhu College
#                                                               2
#                                            Otakaro Pathways Ltd
#                                                              10
#                                       Otorohanga Dental Surgery
#                                                               2
#                                                  OTRS Group Ltd
#                                                               8
#                                      Outome Management Services
#                                                               1
#                                        P.N. Plimmer and Associ.
#                                                               1
#                                     PA Handford and Assoc. Ltd.
#                                                               3
#                                                  Pacific Brands
#                                                               1
#                                 Pacific Edge Biotechnology Ltd.
#                                                               7
#              Pacific Health Research and Development Foundation
#                                                               4
#                                         Pacific Radiology Group
#                                                               7
#            Pacific Women's Health Research and Development Unit
#                                                               7
#                                        Pakuranga Medical Centre
#                                                               7
#                                           Palaecol Research Ltd
#                                                               6
#                                   Palmerston North City Council
#                                                               4
#                                   Palmerston North City Library
#                                                               6
#                                                    Pansophy Ltd
#                                                               5
#                                    Papamoa Pines Medical Centre
#                                                               6
#                                             Paraparaumu College
#                                                               6
#                                                   Paric Limited
#                                                               1
#                                         Parkinson's New Zealand
#                                                               1
#                                       Parresia Research Limited
#                                                               1
#                                            Parsons Brinckerhoff
#                                                               1
#                                     Pasifika Horizon Healthcare
#                                                               1
#                                    Pasifika Medical Association
#                                                               1
#                                           Pasifika Research Ltd
#                                                               6
#                                                         Pathlab
#                                                               7
#                                                  Patients First
#                                                               7
#                                Paton-Simpson Associates Limited
#                                                               9
#                                    Pattle Delamore Partners Ltd
#                                                               8
#                                              Pegasus Health Ltd
#                                                               8
#                                        Penny and Associates Ltd
#                                                               7
#               Perinatal and Maternal Mortality Review Committee
#                                                               7
#                                   Petersgate Counselling Centre
#                                                               8
#                                        PF Olsen and Company Ltd
#                                                              14
#                                        PGG Wrightson Seeds Ltd.
#                                                               5
#                                                         PHARMAC
#                                                               7
#                                              Pharmaceuticol Ltd
#                                                               7
#                                   Pharmacy Guild of New Zealand
#                                                               1
#                                       PharmTech Service Limited
#                                                               2
#                  Philosophy of Education Society of Australasia
#                                                               1
#                                         Photonz Corporation Ltd
#                                                               1
#                                                     Pictor Ltd.
#                                                               1
#                                                 Pingar Research
#                                                               3
#                                              Pinnacle Group Ltd
#                                                              10
#                                                PipeTechnologies
#                                                               1
#                                            Pipfruit New Zealand
#                                                               5
#                                        Planning Consultants Ltd
#                                                               1
#                                         Plant and Food Research
#                                                               5
#                               Plant Protection Chemistry NZ Ltd
#                                                               5
#                                               PlusGroup Limited
#                                                               5
#                                                 Pohatu Penguins
#                                                               5
#                                                 Polybatics Ltd.
#                                                               6
#                                            Porirua City Council
#                                                               2
#                                       Ports of Auckland Limited
#                                                               1
#                                           Positive Thinking Ltd
#                                                               1
#                                              Possum Observatory
#                                                               9
#                                   Potter Building Services Ltd.
#                                                               4
#                                                   Power Co Ltd.
#                                                               1
#                       Power Systems Consultants New Zealand Ltd
#                                                               9
#                                               PowerbyProxi Ltd.
#                                                               1
#                                         Powerhouse Ventures Ltd
#                                                              10
#                                     Practitioners First Limited
#                                                               1
#                              Presbyterian Church of New Zealand
#                                                               1
#                                   PriceWaterhouse Coopers (PwC)
#                                                               2
#                                Priestley Structural Engineering
#                                                               8
#                                     Private Endodontic Practice
#                                                               2
#                                          ProCare Health Limited
#                                                               7
#                                     Prohealth Physiotherapy Ltd
#                                                               1
#                                                    Promisia Ltd
#                                                               2
#                           Proteus Wildlife Research Consultants
#                                                               3
#                                           Psychological Service
#                                                               1
#                                               Psychology Centre
#                                                               7
#                                         Pultron Composites Ltd.
#                                                               3
#                                                         Pyrotek
#                                                               8
#                                                      Q-Bit Ltd.
#                                                               8
#                                                       QE Health
#                                                               1
#                                                      Qnique Ltd
#                                                               6
#                                            QStar Solutions Ltd.
#                                                               3
#                                                       Quadradix
#                                                               1
#                                        Quay Park Medical Centre
#                                                               2
#                                           Queens Academic Group
#                                                               1
#                                      Quest Integrity Group Ltd.
#                                                              11
#                                          Quigley and Watts Ltd.
#                                                              10
#                                    Quin Environmentals(NZ) Ltd.
#                                                               4
#                                  Quintessence Developments Ltd.
#                                                               8
#                                                      Quit Group
#                                                               7
#                                   Radiata Pine Breeding Company
#                                                               3
#                                       Radio Spectrum Management
#                                                               6
#                                                      Rakon Ltd.
#                                                               1
#                                        Rangiora New Life School
#                                                               2
#                         Rape Prevention Education-Whakatu Mauri
#                                                               4
#                             Rauawaawa Kaumatua Charitable Trust
#                                                               2
#                                 Raukatauri Music Therapy Centre
#                                                               1
#                                   Raukura Hauora O Tainui Trust
#                                                               1
#                                        Rayonier New Zealand Ltd
#                                                               8
#                               Refugees as Survivors New Zealand
#                                                               1
#                                   Reid Construction Systems Ltd
#                                                               8
#                                                Renewable Energy
#                                                               3
#                                                        Repromed
#                                                               7
#                                     Reserve Bank of New Zealand
#                                                               3
#                                         Resilient Organisations
#                                                               1
#                        Resource Teacher: Learning and Behaviour
#                                                               1
#                                           Revolution Fibres Ltd
#                                                               6
#                                                Riccarton Rotary
#                                                              17
#                         Risk Strategies Research and Consulting
#                                                               8
#                                              Rivuli Development
#                                                               3
#                                                 RML Engineering
#                                                               3
#                                          Roche Products Limited
#                                                               1
#                                             Rockwell Automation
#                                                               1
#                                     Rolleston Veterinary Clinic
#                                                               3
#                                   Ropata Village Medical Centre
#                                                               7
#                                  Rotorua General Practice Group
#                                                               2
#                                        Rowe Davies Research Ltd
#                                                               1
#       Royal Australian and New Zealand College of Psychiatrists
#                                                               1
#         Royal Forest and Bird Protection Society of New Zealand
#                                                               3
#              Royal New Zealand College of General Practitioners
#                                                               7
#                               Royal New Zealand Plunket Society
#                                                               6
#                                    Royal Society of New Zealand
#                                                               2
#                       Ruaimoko Productions and Consultancy Ltd.
#                                                               2
#                                                      Rumenz Ltd
#                                                              11
#                                                       RuralLink
#                                                               3
#  [ reached getOption("max.print") -- omitted 511 entries ]
ceb
# Установим рабочую директорию
setwd("~/Documents/GitHub/RProjects_EF/Networks")
# Подгрузим необходимые для дальнейшего анализа библиотеки
## install.packages("igraph")
## install.packages("igraphdata")
## install.packages("network")
## install.packages("tidygraph")
## install.packages("ggraph")
## install.packages("visNetwork")
## install.packages("threejs")
## install.packages("networkD3")
## install.packages("DigrammeR")
library(igraph);
library(igraphdata);
# library(intergraph);
library(network);
library(tidygraph);
library(ggraph);
library(visNetwork);
library(threejs);
library(networkD3);
# library(DigrammeR);
# Загрузим данные для исследования
edges <- read.csv("edges_1.csv", header=T)
# edges <- edges[1:500, ]
colnames(edges) <- c('from', 'to', 'type1', 'type2', 'weight')
nodes <- unique(edges[c('from', 'type1')])
more_nodes <- unique(edges[c('to', 'type2')])
colnames(nodes) <- c('organisation', 'type')
colnames(more_nodes) <- c('organisation', 'type')
nodes <- rbind(nodes, more_nodes)
nodes <- unique(nodes[c('organisation', 'type')])
rownames(nodes) <- NULL
edges <- edges[c('from', 'to', 'weight')]
# Создадим также набор обратных величин для весов ребер (это пригодится нам в дальнейшем)
edges_inv <- edges
edges_inv$weight <- 1 / edges_inv$weight
net <- graph_from_data_frame(d=edges, vertices=nodes, directed=F)
net_inv <- graph_from_data_frame(d=edges_inv, vertices=nodes, directed=F)
# направленный граф нужен для визуализации графа при помощи пакета ggraph
net_directed <- graph_from_data_frame(d=edges, vertices=nodes, directed=T)
ceb <- cluster_edge_betweenness(net_inv, weights=E(net_inv)$weight)
mbship_ceb <- membership(ceb)
mbship_ceb
s_ceb <- sizes(ceb)
s_ceb
ms_ceb <- modularity(ceb)
ms_ceb
ceb
ceb.groups
ceb.groups()
ceb$algorithm
ceb
plot(ceb, net)
plot(ceb)
setwd("~/Documents/GitHub/RProjects_EF/Networks")
# Подгрузим необходимые для дальнейшего анализа библиотеки
## install.packages("igraph")
## install.packages("igraphdata")
## install.packages("network")
## install.packages("tidygraph")
## install.packages("ggraph")
## install.packages("visNetwork")
## install.packages("threejs")
## install.packages("networkD3")
## install.packages("DigrammeR")
library(igraph);
library(igraphdata);
# library(intergraph);
library(network);
library(tidygraph);
library(ggraph);
library(visNetwork);
library(threejs);
library(networkD3);
# library(DigrammeR);
# Загрузим данные для исследования
edges <- read.csv("edges_1.csv", header=T)
# edges <- edges[1:500, ]
colnames(edges) <- c('from', 'to', 'type1', 'type2', 'weight')
nodes <- unique(edges[c('from', 'type1')])
more_nodes <- unique(edges[c('to', 'type2')])
colnames(nodes) <- c('organisation', 'type')
colnames(more_nodes) <- c('organisation', 'type')
nodes <- rbind(nodes, more_nodes)
nodes <- unique(nodes[c('organisation', 'type')])
rownames(nodes) <- NULL
edges <- edges[c('from', 'to', 'weight')]
# Создадим также набор обратных величин для весов ребер (это пригодится нам в дальнейшем)
edges_inv <- edges
edges_inv$weight <- 1 / edges_inv$weight
net <- graph_from_data_frame(d=edges, vertices=nodes, directed=F)
net_inv <- graph_from_data_frame(d=edges_inv, vertices=nodes, directed=F)
# направленный граф нужен для визуализации графа при помощи пакета ggraph
net_directed <- graph_from_data_frame(d=edges, vertices=nodes, directed=T)
ceb <- cluster_edge_betweenness(net_inv, weights=E(net_inv)$weight)
mbship_ceb <- membership(ceb)
s_ceb <- sizes(ceb)
s_ceb
ms_ceb <- modularity(ceb)
ms_ceb
ceb
plot(net, ceb)
plot(ceb, net)
V(net_inv)
V(net_inv)$type
V(net_inv)$color <- ifelse( V(net_inv)$type=="Business Enterprise", "red",
ifelse( V(net_inv)$type=="Private not for profit", "purple",
ifelse( V(net_inv)$type=="Government", "green",
ifelse( V(net_inv)$type=="Higher Education", "blue") ) ) )
V(net_inv)$color <- ifelse( V(net_inv)$type=="Business Enterprise", "red",
ifelse( V(net_inv)$type=="Private not for profit", "purple",
ifelse( V(net_inv)$type=="Government", "green",
ifelse( V(net_inv)$type=="Higher Education", "blue", no) ) ) )
V(net_inv)$color <- ifelse( V(net_inv)$type=="Business Enterprise", "red",
ifelse( V(net_inv)$type=="Private not for profit", "purple",
ifelse( V(net_inv)$type=="Government", "green",
ifelse( V(net_inv)$type=="Higher Education", "blue", "black") ) ) )
plot( ceb, net, vertex.color=c(V(net_inv)$color) )
V(net_inv)$color
unique( V(net_inv)$color )
plot( ceb, net, vertex.color=c("red", "purple", "green", "blue") )
plot( ceb, net, vertex.color=V(net_inv)$color )
plot( ceb, net_inv, vertex.color=V(net_inv)$color )
plot( ceb, net_inv, vertex.color=c("red", "purple", "green", "blue") )
plot( ceb, net_inv, vertex.label=V(net_inv)$type )
cfg <- cluster_fast_greedy(net_inv, weights=E(net_inv)$weight)
# plot(cfg, net)
mbship_cfg <- membership(cfg)
# mbship_cfg
s_cfg <- sizes(cfg)
s_cfg
ms_cfg <- modularity(cfg)
ms_cfg
cfg
plot(cfg, net)
data(karate)
p <- edge_density(karate)
assortativity_degree(karate)
vertex_attr(karate) # если фракция только 1 или 2, то это одинаковые корреляции будут
assortativity_nominal(karate, types = V(karate)$Faction)
assortativity(karate, types1 = V(karate)$Faction)
gl <- vector('list', 1000)
m <- rep(NA, 1000)
for(i in 1:1000){
gl[[i]] <- erdos.renyi.game(n = gorder(karate), p.or.m = p, type = "gnp")
m[i] <- assortativity(gl[[i]], types1 = sample(V(karate)$Faction))
}
hist(m, xlim = range(c(-1, 1)))
abline(v = assortativity(karate, types1 = V(karate)$Faction), col = "red", lty = 3, lwd = 2)
V(karate)$name <- seq(from = 1, to = 34)
edgeList <- as_edgelist(karate)
faction <- matrix(c(V(karate)$name, V(karate)$Faction), nrow = 34, ncol = 2)
FromLabel <- as.numeric(faction[match(as.numeric(edgeList[,1]), as.numeric(faction[,1])), 2]) # match(x, y) returns a vector with the location of x in y
ToLabel <- as.numeric(faction[match(as.numeric(edgeList[,2]), as.numeric(faction[,1])), 2])
edgeType <- FromLabel + ToLabel
table(edgeType)
table(as.numeric(faction[,2]))
exp_dyad <- table(as.numeric(faction[,2]))[1] * (table(as.numeric(faction[,2]))[1] - 1) * p/2
dyadicity <- table(edgeType)[1] / exp_dyad
exp_hetero <- table(as.numeric(faction[,2]))[1] * table(as.numeric(faction[,2]))[2] * p
heterophilicity <- table(edgeType)[2] / exp_hetero
data(karate)
p <- edge_density(karate)
transitivity(karate, type = "local")
transitivity(karate, type = "global")
gl <- vector('list', 1000)
m <- rep(NA, 1000)
for(i in 1:1000){
gl[[i]] <- erdos.renyi.game(n = gorder(karate), p.or.m = p, type = "gnp")
m[i] <- transitivity(gl[[i]], type = "global")
}
hist(m, xlim = range(c(0, 1)))
abline(v = transitivity(karate, type = "global"), col = "red", lty = 3, lwd = 2)
components(karate) # компоненты связности
largest_cliques(karate)
vcol <- rep("grey80", vcount(karate))
vcol[unlist(largest_cliques(karate)[[1]])] <- "gold"
plot(karate, vertex.label = NA, vertex.color = vcol, layout = layout_with_fr)
kc <- coreness(karate) # subgraph in which every node has degree of at least k
max(kc)
table(kc)
colrs <- c("gray50", "tomato", "gold", "yellowgreen")
plot(karate, vertex.size = kc*3, vertex.label = kc, vertex.color = colrs[kc], layout = layout_with_fr)
ceb <- cluster_edge_betweenness(karate, weights = NULL)
plot(ceb, karate)
membership(ceb)
sizes(ceb)
modularity(ceb)
plot(karate)
plot(ceb, karate)
cfg <- cluster_fast_greedy(karate, weights = NULL)
plot(cfg, karate)
membership(cfg)
sizes(cfg)
modularity(cfg)
# функция compare() считает whether or not any two vertices are members of the same community
compare(ceb, cfg)
hist(m, xlim = range(c(-1, 1)))
abline(v = assortativity(karate, types1 = V(karate)$Faction), col = "red", lty = 3, lwd = 2)
faction
table(edgeType)
V(karate)$name <- seq(from = 1, to = 34)
edgeList <- as_edgelist(karate)
faction <- matrix(c(V(karate)$name, V(karate)$Faction), nrow = 34, ncol = 2)
FromLabel <- as.numeric(faction[match(as.numeric(edgeList[,1]), as.numeric(faction[,1])), 2]) # match(x, y) returns a vector with the location of x in y
FromLabel
ToLabel <- as.numeric(faction[match(as.numeric(edgeList[,2]), as.numeric(faction[,1])), 2])
ToLabel
edgeType <- FromLabel + ToLabel
edgeType
table(edgeType)
table(as.numeric(faction[,2]))
table(as.numeric(faction))
faction[,2]
